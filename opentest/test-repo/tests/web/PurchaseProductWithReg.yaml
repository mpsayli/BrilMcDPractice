description: Purchase product via Reg
actors:
  - actor: WEB
    segments:
      - segment: 1
        actions:

          - macro: Registration

          - description: Move the mouse to product 1 element
            action: org.getopentest.selenium.ActionsMoveTo
            args:
               locator: { xpath: "//ul[@class='top-menu']/li[3]/a" }

          - description: Pause for 4 seconds
            action: org.getopentest.selenium.ActionsPause
            args:
               durationMs: 4000

          - description: Take screen shot
            action: org.getopentest.selenium.TakeScreenshot

          - description: Performs gestures
            action: org.getopentest.selenium.ActionsPerform

          - description: Click on "Cell phones" link
            action: org.getopentest.selenium.Click
            args:
              locator: {xpath: "(//a[contains(@href,'cell-phones')])[1]"}

          - description: Product select "Cell phones" page
            action: org.getopentest.selenium.TakeScreenshot

          - description: Verify the "Cell phones" text
            action: org.getopentest.selenium.AssertElementText
            args:
              locator: { xpath: "//div[@class='page-title']/h1" }
              textContains: Cell phones

          - description: Click on add to cart button regards cell phone
            action: org.getopentest.selenium.Click
            args:
              locator: {xpath: "//div[@class='item-box']//h2/a[contains(@href,'smartphone')]/../following-sibling::div[@class='add-info']//input[@type='button']"}

          - description: Verify the "The product has been added to your" text
            action: org.getopentest.selenium.AssertElementText
            args:
              locator: { xpath: "//p[@class='content']" }
              textContains: The product has been added to your
          
          - description: The product has been added to your cart
            action: org.getopentest.selenium.TakeScreenshot

          # Verify product has been added or not
          - description: Move the mouse to shopping cart
            action: org.getopentest.selenium.ActionsMoveTo
            args:
              locator: { xpath: "(//*[@class='ico-cart'])[1]" }

          - description: Pause for 3 seconds
            action: org.getopentest.selenium.ActionsPause
            args:
              durationMs: 3000
          
          - description: Mouse over on shopping cart
            action: org.getopentest.selenium.TakeScreenshot

          - description: Performs gestures
            action: org.getopentest.selenium.ActionsPerform

          - description: Verify "Quantity on shopping cart"
            action: org.getopentest.selenium.AssertElementText
            args:
              locator: { xpath: "(//*[@class='ico-cart'])[1]/span[@class='cart-qty']" }
              textContains: (1)

          - description: Click on "Go to cart" link
            action: org.getopentest.selenium.Click
            args:
              locator: {xpath: "//input[@value='Go to cart']"}

          - script: $delay(3000)

          # Shopping cart 

          - description: Shopping cart page
            action: org.getopentest.selenium.TakeScreenshot

          - description: Verify "Quantity on shopping cart"
            action: org.getopentest.selenium.AssertElementText
            args:
              locator: { css: '.page-title h1' }
              textContains: Shopping cart
          
          - description: Select "India" in the countries list
            action: org.getopentest.selenium.SelectListOption
            args:
              locator: { xpath: "//select[@name='CountryId']" }
              optionValue: 41
          
          - description: Clear the text content of the zip code textbox
            action: org.getopentest.selenium.ClearContent
            args:
              locator: { xpath: "//label[@for='ZipPostalCode']/following-sibling::input" }

          - description: Type enter "ZIP Code" in the input field
            action: org.getopentest.selenium.SendKeys
            args:
              locator: { xpath: "//label[@for='ZipPostalCode']/following-sibling::input" }
              text: 500082

          - description: Click on Terms and conditions checkbox
            action: org.getopentest.selenium.Click
            args:
              locator: {xpath: "//input[@id='termsofservice']"}

          - description: Click on Check out button
            action: org.getopentest.selenium.Click
            args:
              locator: {xpath: "//button[@id='checkout']"}

          - description: Shopping cart page
            action: org.getopentest.selenium.TakeScreenshot

          - script: $delay(3000)

          # Billing address
          - description: Select "India" in the countries list
            action: org.getopentest.selenium.SelectListOption
            args:
              locator: { xpath: "//select[@id='BillingNewAddress_CountryId']" }
              optionValue: 41

          - script: $delay(3000)
          
          - description: Type enter "City" in the input field
            action: org.getopentest.selenium.SendKeys
            args:
              locator: { xpath: "//label[@for='BillingNewAddress_City']/following-sibling::input" }
              text: Hyderabad

          - description: Type enter "Address1" in the input field
            action: org.getopentest.selenium.SendKeys
            args:
              locator: { xpath: "//label[@for='BillingNewAddress_Address1']/following-sibling::input" }
              text: 3-200

          - description: Type enter "ZIP Code" in the input field
            action: org.getopentest.selenium.SendKeys
            args:
              locator: { xpath: "//label[@for='BillingNewAddress_ZipPostalCode']/following-sibling::input" }
              text: 500082

          - description: Type enter "Phone number" in the input field
            action: org.getopentest.selenium.SendKeys
            args:
              locator: { xpath: "//label[@for='BillingNewAddress_PhoneNumber']/following-sibling::input" }
              text: 9908099680
          
          - description: Click on "Contunue" button
            action: org.getopentest.selenium.Click
            args:
              locator: {xpath: "//*[@id='billing-buttons-container']//input"}

          - description: Click on "Contunue" button
            action: org.getopentest.selenium.Click
            args:
              locator: {xpath: "//*[@id='shipping-buttons-container']//input"}

          - script: $delay(2000)

          - description: Click on "Contunue" button
            action: org.getopentest.selenium.Click
            args:
              locator: {xpath: "//*[@id='shipping-method-buttons-container']//input"}
          
          - script: $delay(2000)

          - description: Click on "Contunue" button
            action: org.getopentest.selenium.Click
            args:
              locator: {xpath: "//*[@id='payment-method-buttons-container']//input"}
          
          - script: $delay(2000)

          - description: Click on "Contunue" button
            action: org.getopentest.selenium.Click
            args:
              locator: {xpath: "//*[@id='payment-info-buttons-container']//input"}
          
          - script: $delay(4000)

          - description: Click on "Confirm" button
            action: org.getopentest.selenium.Click
            args:
              locator: {xpath: "//*[@id='confirm-order-buttons-container']//input"}
          
          # Order details page
          - description: Billing address page
            action: org.getopentest.selenium.TakeScreenshot

          - description: Verify "Thank you"
            action: org.getopentest.selenium.AssertElementText
            args:
              locator: { xpath: "//div[@class='page-title']/h1" }
              textContains: Thank you

          - description: Verify "Your order has been successfully processed!"
            action: org.getopentest.selenium.AssertElementText
            args:
              locator: { xpath: "//div[@class='title']/strong" }
              textContains: Your order has been successfully processed!

          - description: Verify "Order number"
            action: org.getopentest.selenium.AssertElementText
            args:
              locator: { xpath: "//ul[@class='details']/li" }
              textContains: Order number

          - description: Verify "Click here for order details."
            action: org.getopentest.selenium.AssertElementText
            args:
              locator: { xpath: "//a[contains(@href,'orderdetails')]" }
              textContains: Click here for order details.

          - description: Read the product order number
            action: org.getopentest.selenium.ReadElementText
            args:
              locator: { xpath: "//ul[@class='details']/li" }
              $localData:
                  orderNumber: $output.text
          
          # Verify shopping cart count
          - description: shopping cart count
            action: org.getopentest.selenium.TakeScreenshot

          - description: Verify "Quantity on shopping cart"
            action: org.getopentest.selenium.AssertElementText
            args:
              locator: { xpath: "(//*[@class='ico-cart'])[1]/span[@class='cart-qty']" }
              textContains: (0)

          - script: $log("The order number is " + $localData.orderNumber.match(/\d+/));
          - description: Click on logout button
            action: org.getopentest.selenium.Click
            args:
              locator: { css: '.ico-logout' }
          - script: $log("Order placed successfully.....!!!")
